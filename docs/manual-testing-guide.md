# Phase 1.6 手动测试指南

## 📋 测试概览

本指南将帮助你完成 Phase 1 的手动集成测试。自动化测试已经 100% 通过，现在需要在浏览器中测试以下功能：

- ✅ **自动化测试**: Token 计数 (25/25 通过)
- ⏳ **手动测试**: Markdown 渲染
- ⏳ **手动测试**: 消息编辑与重新生成
- ⏳ **手动测试**: UI 响应式和动画

---

## 🚀 开始测试

### 1. 启动应用

```bash
cd emotichat
npm run dev
```

打开浏览器访问：http://localhost:3000

---

## 📝 Markdown 渲染测试

### 测试准备

1. 创建一个新对话
2. 依次发送以下测试用例
3. 验证每个测试用例的渲染结果
4. 在 `docs/phase-1-testing-report.md` 中记录结果

### 测试用例

#### 测试 1: JavaScript 代码块

**发送内容**:
```
测试 JavaScript 代码高亮：

\`\`\`javascript
const hello = "world";
console.log(hello);

function add(a, b) {
  return a + b;
}
\`\`\`
```

**验证**:
- [ ] 代码块有背景色
- [ ] 右上角显示 "javascript" 标签
- [ ] 语法高亮正确（关键字、字符串、函数等有不同颜色）
- [ ] 深色/明亮模式都清晰可读

---

#### 测试 2: Python 代码块

**发送内容**:
```
测试 Python 代码高亮：

\`\`\`python
def hello():
    print("Hello, world!")
    
class Person:
    def __init__(self, name):
        self.name = name
\`\`\`
```

**验证**:
- [ ] Python 语法高亮正确
- [ ] 缩进显示正确
- [ ] 关键字（def, class 等）高亮

---

#### 测试 3: 行内代码

**发送内容**:
```
这是一段包含 \`inline code\` 的文本，还有 \`const x = 1\` 和 \`print("test")\`。
```

**验证**:
- [ ] 行内代码有不同的背景色
- [ ] 等宽字体显示
- [ ] 与普通文本有明显区分

---

#### 测试 4: LaTeX 行内公式

**发送内容**:
```
这是爱因斯坦的质能方程：$E = mc^2$

圆的面积公式：$A = \pi r^2$

二次方程：$ax^2 + bx + c = 0$
```

**验证**:
- [ ] 公式正确渲染（不是原始 LaTeX 代码）
- [ ] 上标、下标显示正确
- [ ] 希腊字母显示正确
- [ ] 深色模式下可读

---

#### 测试 5: LaTeX 块级公式

**发送内容**:
```
高斯积分：

$$
\int_{0}^{\infty} e^{-x^2} dx = \frac{\sqrt{\pi}}{2}
$$

求和公式：

$$
\sum_{i=1}^{n} i = \frac{n(n+1)}{2}
$$
```

**验证**:
- [ ] 公式居中显示
- [ ] 积分符号、求和符号正确
- [ ] 分数显示正确
- [ ] 公式大小适中

---

#### 测试 6: 表格

**发送内容**:
```
| 姓名 | 年龄 | 城市 |
|------|------|------|
| 张三 | 25   | 北京 |
| 李四 | 30   | 上海 |
| 王五 | 28   | 广州 |
```

**验证**:
- [ ] 表格边框清晰
- [ ] 表头有不同样式
- [ ] 单元格内容对齐
- [ ] 移动端可横向滚动

---

#### 测试 7: 列表

**发送内容**:
```
无序列表：
- 第一项
- 第二项
- 第三项

有序列表：
1. 第一步
2. 第二步
3. 第三步

嵌套列表：
1. 主项目
   - 子项 1
   - 子项 2
2. 另一个主项目
```

**验证**:
- [ ] 无序列表使用圆点
- [ ] 有序列表有正确编号
- [ ] 嵌套层级清晰
- [ ] 缩进合理

---

#### 测试 8: 引用块

**发送内容**:
```
> 这是一段引用文本。
> 
> 可以有多行内容。
> 
> 也可以包含**强调文本**。
```

**验证**:
- [ ] 左侧有竖线标记
- [ ] 背景色或文字颜色有区分
- [ ] 多行引用显示正确

---

#### 测试 9: 标题层级

**发送内容**:
```
# 一级标题
## 二级标题
### 三级标题
#### 四级标题
##### 五级标题
###### 六级标题
```

**验证**:
- [ ] 字体大小递减
- [ ] 层级清晰
- [ ] 上下间距合理

---

#### 测试 10: 链接

**发送内容**:
```
这是一个[内部链接](/test)和一个[外部链接](https://example.com)。

外部链接应该在新标签页打开。
```

**验证**:
- [ ] 链接有不同颜色（通常是蓝色）
- [ ] 悬停时有下划线
- [ ] 外部链接点击后在新标签页打开
- [ ] 内部链接在当前页面跳转

---

#### 测试 11: 文本强调

**发送内容**:
```
这是**粗体文本**和*斜体文本*。

这是~~删除线文本~~。

也可以组合：**粗体加*斜体*组合**。
```

**验证**:
- [ ] 粗体字重明显
- [ ] 斜体倾斜明显
- [ ] 删除线有中划线
- [ ] 组合效果正确

---

#### 测试 12: 分隔线

**发送内容**:
```
上方内容

---

下方内容
```

**验证**:
- [ ] 分隔线清晰可见
- [ ] 上下间距合理

---

#### 测试 13: 混合内容

**发送内容**:
```
# Markdown 综合测试

这是一段包含 **粗体** 和 *斜体* 的文本。

## 代码示例

\`\`\`typescript
function add(a: number, b: number): number {
  return a + b;
}
\`\`\`

## 数学公式

行内公式：$f(x) = x^2$

块级公式：
$$
\int_{0}^{\infty} e^{-x^2} dx = \frac{\sqrt{\pi}}{2}
$$

## 表格

| 名称 | 值 |
|------|-----|
| A    | 1   |
| B    | 2   |

## 列表

1. 第一项
2. 第二项
   - 子项 1
   - 子项 2

> 这是一段引用文本。
```

**验证**:
- [ ] 所有元素都正确渲染
- [ ] 元素之间间距合理
- [ ] 整体排版美观

---

## ✏️ 消息编辑与重新生成测试

### 测试用户消息编辑

1. **发送一条消息**: "Hello, how are you?"
2. **悬停消息**: 应该出现编辑按钮
3. **点击编辑按钮**: 
   - [ ] 显示编辑框
   - [ ] 光标在文本末尾
   - [ ] 文本区域自动调整高度
4. **修改内容**: 改为 "Hello, how are you doing?"
5. **按 Ctrl+Enter**: 
   - [ ] 消息内容已更新
   - [ ] 显示"已编辑"标记
   - [ ] 编辑框消失
6. **测试取消**: 再次编辑，按 Esc
   - [ ] 编辑框消失
   - [ ] 内容未改变

### 测试空消息和未修改消息

1. **编辑消息，清空内容，点击保存**:
   - [ ] 保存按钮应该是禁用状态
   - [ ] 无法保存空消息
2. **编辑消息但不修改，点击保存**:
   - [ ] 应该直接取消编辑（因为没有变化）

### 测试 AI 消息重新生成

1. **发送消息触发 AI 回复**
2. **悬停 AI 消息**: 应该出现重新生成按钮
3. **点击重新生成**:
   - [ ] AI 开始重新生成回复
   - [ ] 生成新版本后，版本选择器出现
   - [ ] 显示"已重新生成 1 次"
4. **再次重新生成**:
   - [ ] 版本数增加
   - [ ] 计数器更新

### 测试版本管理

1. **在有多个版本的消息上**:
   - [ ] 版本选择器显示当前版本号（如 "1/3"）
   - [ ] 点击左箭头切换到上一版本
   - [ ] 点击右箭头切换到下一版本
   - [ ] 内容正确切换
   - [ ] 当前版本高亮显示

### 测试消息删除

1. **悬停消息，点击删除按钮**:
   - [ ] 显示确认对话框
   - [ ] 确认后消息被删除
2. **点击"删除后续消息"**:
   - [ ] 确认后，该消息之后的所有消息都被删除

---

## 📱 UI 响应式测试

### 桌面布局测试（> 1024px）

使用浏览器开发者工具，设置视口为 1440px 或更大：

- [ ] 侧边栏固定显示，宽度合适（约 250-300px）
- [ ] 消息列表居中，最大宽度合理（不会太宽）
- [ ] 输入框宽度匹配消息区域
- [ ] 按钮和图标大小合适（不会太大或太小）
- [ ] Token 计数器位置合理
- [ ] 对话列表完整显示

### 平板布局测试（768px - 1024px）

设置视口为 768px - 1024px：

- [ ] 侧边栏可以通过汉堡菜单切换
- [ ] 消息列表适应可用宽度
- [ ] 输入框适应宽度
- [ ] 触摸目标大小至少 44px × 44px
- [ ] 滚动流畅
- [ ] 内容不会被截断

### 手机布局测试（< 768px）

设置视口为 375px（iPhone SE）和 414px（iPhone Plus）：

- [ ] 侧边栏使用抽屉/Sheet 模式
- [ ] 点击遮罩层可关闭侧边栏
- [ ] 消息占据大部分宽度（90%+）
- [ ] 输入框占满可用宽度
- [ ] 按钮足够大，易于点击
- [ ] 虚拟键盘弹出时，输入框可见
- [ ] 横屏模式布局合理
- [ ] 文字大小可读（不会太小）

### 主题切换测试

1. **切换到深色模式**:
   - [ ] 所有文本清晰可读
   - [ ] 背景和前景有足够对比度
   - [ ] 代码块在深色背景下可读
   - [ ] LaTeX 公式可见
   - [ ] 边框和分隔线清晰
   - [ ] 表格在深色模式下正常

2. **切换到明亮模式**:
   - [ ] 同样检查所有元素
   - [ ] 过渡流畅，无闪烁

3. **快速切换测试**:
   - [ ] 连续切换 3-5 次
   - [ ] 无卡顿或闪烁
   - [ ] 状态保持正确

### 动画效果测试

1. **消息动画**:
   - [ ] 新消息淡入并从底部滑入
   - [ ] 动画流畅（约 300ms）
   - [ ] 多条消息依次出现

2. **悬停效果**:
   - [ ] 按钮悬停时有视觉反馈
   - [ ] 消息悬停时操作按钮淡入
   - [ ] 过渡流畅

3. **模态框动画**:
   - [ ] 打开时从中心放大
   - [ ] 关闭时淡出
   - [ ] 背景遮罩淡入淡出

4. **加载状态**:
   - [ ] AI 回复时有加载指示
   - [ ] 动画流畅不卡顿

### 可访问性测试

1. **键盘导航**:
   - [ ] 按 Tab 可以遍历所有可交互元素
   - [ ] Tab 顺序符合逻辑（从上到下，从左到右）
   - [ ] 焦点指示清晰可见
   - [ ] Enter 键可以激活按钮
   - [ ] Esc 键可以关闭对话框

2. **ARIA 标签**:
   - [ ] 使用屏幕阅读器检查（可选）
   - [ ] 按钮有描述性标签
   - [ ] 表单元素有关联的 label

---

## 🐛 Bug 记录

在测试过程中发现任何问题，请在 `docs/phase-1-testing-report.md` 中记录：

### Bug 模板

```markdown
#### Bug #X: [简短描述]
- **严重程度**: [高/中/低]
- **影响范围**: [具体组件或功能]
- **复现步骤**:
  1. ...
  2. ...
- **预期行为**: ...
- **实际行为**: ...
- **截图**: [如有]
- **浏览器**: Chrome 120 / Firefox 121 / Safari 17 等
- **设备**: Desktop / iPad / iPhone
- **状态**: ⏳ 待修复
```

### 严重程度分类

- **高**: 功能完全无法使用，严重影响用户体验
- **中**: 功能部分可用，但有明显问题
- **低**: 小问题，不影响主要功能

---

## ✅ 完成测试后

1. **更新测试报告**: 在 `docs/phase-1-testing-report.md` 中标记所有测试项的状态
2. **列出所有发现的 Bug**: 按严重程度排序
3. **通知 AI 助手**: 报告测试结果和发现的问题
4. **等待 Bug 修复**: AI 助手将协助修复问题
5. **回归测试**: 修复后重新测试相关功能

---

## 📊 测试进度追踪

使用 `docs/phase-1-testing-report.md` 中的清单来追踪进度：

- [ ] Markdown 渲染测试完成
- [ ] 消息编辑测试完成
- [ ] UI 响应式测试完成
- [ ] Bug 已记录
- [ ] 所有 Bug 已修复
- [ ] 回归测试通过

---

## 💡 提示

- **多个浏览器测试**: 建议在 Chrome、Firefox 和 Safari 中都测试
- **真实设备测试**: 如果可能，在真实的移动设备上测试
- **记录截图**: 遇到问题时截图保存，方便后续修复
- **详细记录**: 越详细的 Bug 描述，越容易修复
- **专注测试**: 一次只测试一个功能，避免遗漏

祝测试顺利！🎉