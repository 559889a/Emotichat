# ç»„ä»¶è·¯å¾„ç´¢å¼•

> å¿«é€ŸæŸ¥æ‰¾ç»„ä»¶æ–‡ä»¶ä½ç½®
> é¡¹ç›®æ ¹ç›®å½•ï¼š`D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\`

---

## ğŸ“ ç›®å½•ç»“æ„æ¦‚è§ˆ

```
emotichat/
â”œâ”€â”€ app/                          # Next.js åº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ (main)/                  # ä¸»åº”ç”¨è·¯ç”±ç»„
â”‚   â”‚   â”œâ”€â”€ chat/               # èŠå¤©é¡µé¢
â”‚   â”‚   â”œâ”€â”€ characters/         # è§’è‰²ç®¡ç†é¡µé¢
â”‚   â”‚   â””â”€â”€ settings/           # è®¾ç½®é¡µé¢
â”‚   â”œâ”€â”€ api/                     # API è·¯ç”±
â”‚   â””â”€â”€ layout.tsx              # æ ¹å¸ƒå±€
â”œâ”€â”€ components/                   # React ç»„ä»¶
â”‚   â”œâ”€â”€ ui/                     # åŸºç¡€UIç»„ä»¶
â”‚   â”œâ”€â”€ layout/                 # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ chat/                   # èŠå¤©åŠŸèƒ½ç»„ä»¶
â”‚   â”œâ”€â”€ character/              # è§’è‰²ç®¡ç†ç»„ä»¶
â”‚   â”œâ”€â”€ prompt/                 # æç¤ºè¯ç¼–è¾‘ç»„ä»¶
â”‚   â””â”€â”€ settings/               # è®¾ç½®ç»„ä»¶
â”œâ”€â”€ lib/                         # æ ¸å¿ƒåº“æ–‡ä»¶
â”‚   â”œâ”€â”€ ai/                     # AIæ¨¡å‹ç³»ç»Ÿ
â”‚   â”œâ”€â”€ storage/                # æ•°æ®å­˜å‚¨
â”‚   â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”œâ”€â”€ stores/                      # Zustand çŠ¶æ€ç®¡ç†
â”œâ”€â”€ hooks/                       # è‡ªå®šä¹‰ React Hooks
â””â”€â”€ docs/                        # æ–‡æ¡£ç›®å½•
    â””â”€â”€ testing/                # æµ‹è¯•æ–‡æ¡£
```

---

## ğŸ—‚ï¸ ç»„ä»¶å®Œæ•´è·¯å¾„åˆ—è¡¨

### UI åŸºç¡€ç»„ä»¶ (`components/ui/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\components\ui\
â”œâ”€â”€ button.tsx              # æŒ‰é’®ç»„ä»¶
â”œâ”€â”€ input.tsx               # æ–‡æœ¬è¾“å…¥æ¡†
â”œâ”€â”€ textarea.tsx            # å¤šè¡Œæ–‡æœ¬æ¡†
â”œâ”€â”€ select.tsx              # ä¸‹æ‹‰é€‰æ‹©æ¡†
â”œâ”€â”€ slider.tsx              # æ»‘å—ç»„ä»¶
â”œâ”€â”€ switch.tsx              # å¼€å…³ç»„ä»¶
â”œâ”€â”€ card.tsx                # å¡ç‰‡å®¹å™¨
â”œâ”€â”€ dialog.tsx              # å¯¹è¯æ¡†
â”œâ”€â”€ sheet.tsx               # ä¾§é¢æ¿
â”œâ”€â”€ popover.tsx             # å¼¹å‡ºæ¡†
â”œâ”€â”€ tabs.tsx                # æ ‡ç­¾é¡µ
â”œâ”€â”€ alert.tsx               # è­¦å‘Šæç¤º
â”œâ”€â”€ alert-dialog.tsx        # è­¦å‘Šå¯¹è¯æ¡†
â”œâ”€â”€ badge.tsx               # å¾½ç« æ ‡ç­¾
â”œâ”€â”€ avatar.tsx              # ç”¨æˆ·å¤´åƒ
â”œâ”€â”€ scroll-area.tsx         # æ»šåŠ¨åŒºåŸŸ
â”œâ”€â”€ tooltip.tsx             # å·¥å…·æç¤º
â”œâ”€â”€ dropdown-menu.tsx       # ä¸‹æ‹‰èœå•
â”œâ”€â”€ label.tsx               # æ ‡ç­¾æ–‡æœ¬
â”œâ”€â”€ collapsible.tsx         # å¯æŠ˜å é¢æ¿
â””â”€â”€ command.tsx             # å‘½ä»¤èœå•
```

### å¸ƒå±€ç»„ä»¶ (`components/layout/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\components\layout\
â”œâ”€â”€ sidebar.tsx             # ä¾§è¾¹å¯¼èˆªæ 
â”œâ”€â”€ header.tsx              # ç§»åŠ¨ç«¯å¤´éƒ¨
â”œâ”€â”€ theme-provider.tsx      # ä¸»é¢˜æä¾›è€…
â”œâ”€â”€ theme-toggle.tsx        # ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
â””â”€â”€ error-boundary.tsx      # é”™è¯¯è¾¹ç•Œ
```

### èŠå¤©åŠŸèƒ½ç»„ä»¶ (`components/chat/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\components\chat\
â”œâ”€â”€ message-list.tsx                      # æ¶ˆæ¯åˆ—è¡¨å®¹å™¨
â”œâ”€â”€ message-bubble.tsx                    # æ¶ˆæ¯æ°”æ³¡
â”œâ”€â”€ message-editor.tsx                    # æ¶ˆæ¯ç¼–è¾‘å™¨
â”œâ”€â”€ message-actions.tsx                   # æ¶ˆæ¯æ“ä½œæ 
â”œâ”€â”€ version-selector.tsx                  # ç‰ˆæœ¬é€‰æ‹©å™¨
â”œâ”€â”€ chat-input.tsx                        # èŠå¤©è¾“å…¥æ¡†
â”œâ”€â”€ welcome-screen.tsx                    # æ¬¢è¿å±å¹•
â”œâ”€â”€ conversation-list.tsx                 # å¯¹è¯åˆ—è¡¨
â”œâ”€â”€ new-conversation-dialog.tsx           # æ–°å»ºå¯¹è¯å¯¹è¯æ¡†
â”œâ”€â”€ conversation-settings-dialog.tsx      # å¯¹è¯è®¾ç½®å¯¹è¯æ¡†
â”œâ”€â”€ conversation-prompt-config.tsx        # å¯¹è¯æç¤ºè¯é…ç½®
â”œâ”€â”€ model-selector.tsx                    # æ¨¡å‹é€‰æ‹©å™¨
â”œâ”€â”€ model-parameters.tsx                  # æ¨¡å‹å‚æ•°é…ç½®
â”œâ”€â”€ token-counter.tsx                     # Tokenè®¡æ•°å™¨
â”œâ”€â”€ markdown-renderer.tsx                 # Markdownæ¸²æŸ“å™¨
â””â”€â”€ dev-mode-panel.tsx                    # å¼€å‘è€…æ¨¡å¼é¢æ¿
```

### è§’è‰²ç®¡ç†ç»„ä»¶ (`components/character/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\components\character\
â”œâ”€â”€ character-card.tsx      # è§’è‰²å¡ç‰‡
â”œâ”€â”€ character-form.tsx      # è§’è‰²ç¼–è¾‘è¡¨å•
â””â”€â”€ prompt-config.tsx       # è§’è‰²æç¤ºè¯é…ç½®
```

### æç¤ºè¯ç¼–è¾‘ç»„ä»¶ (`components/prompt/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\components\prompt\
â”œâ”€â”€ prompt-editor.tsx           # æç¤ºè¯ç¼–è¾‘å™¨
â”œâ”€â”€ prompt-item-editor.tsx      # æç¤ºè¯æ¡ç¼–è¾‘
â”œâ”€â”€ prompt-preview.tsx          # æç¤ºè¯é¢„è§ˆ
â””â”€â”€ variable-insert-menu.tsx    # å˜é‡æ’å…¥èœå•
```

### è®¾ç½®ç»„ä»¶ (`components/settings/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\components\settings\
â”œâ”€â”€ api-keys.tsx                # APIå¯†é’¥ç®¡ç†
â”œâ”€â”€ custom-provider-dialog.tsx  # è‡ªå®šä¹‰æä¾›å•†
â”œâ”€â”€ preset-editor.tsx           # é¢„è®¾ç¼–è¾‘å™¨
â”œâ”€â”€ authors-note-editor.tsx     # ä½œè€…ç¬”è®°ç¼–è¾‘å™¨
â””â”€â”€ scenario-editor.tsx         # åœºæ™¯ç¼–è¾‘å™¨
```

### é¡µé¢ç»„ä»¶ (`app/(main)/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\app\(main)\
â”œâ”€â”€ chat/
â”‚   â””â”€â”€ page.tsx                # èŠå¤©é¡µé¢
â”œâ”€â”€ characters/
â”‚   â””â”€â”€ page.tsx                # è§’è‰²ç®¡ç†é¡µé¢
â”œâ”€â”€ settings/
â”‚   â”œâ”€â”€ page.tsx                # è®¾ç½®é¡µé¢
â”‚   â””â”€â”€ prompts/
â”‚       â””â”€â”€ page.tsx            # æç¤ºè¯è®¾ç½®é¡µé¢
â””â”€â”€ layout.tsx                  # ä¸»åº”ç”¨å¸ƒå±€
```

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\app\
â””â”€â”€ layout.tsx                  # æ ¹å¸ƒå±€
```

### API è·¯ç”± (`app/api/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\app\api\
â”œâ”€â”€ conversations/
â”‚   â”œâ”€â”€ route.ts                            # å¯¹è¯åˆ—è¡¨ GET/POST
â”‚   â””â”€â”€ [id]/
â”‚       â”œâ”€â”€ route.ts                        # å•ä¸ªå¯¹è¯ GET/PUT/DELETE
â”‚       â””â”€â”€ messages/
â”‚           â”œâ”€â”€ route.ts                    # å¯¹è¯æ¶ˆæ¯ GET/POST
â”‚           â””â”€â”€ [messageId]/
â”‚               â””â”€â”€ route.ts                # å•æ¡æ¶ˆæ¯ PUT/DELETE
â”œâ”€â”€ characters/
â”‚   â”œâ”€â”€ route.ts                            # è§’è‰²åˆ—è¡¨ GET/POST
â”‚   â””â”€â”€ [id]/
â”‚       â””â”€â”€ route.ts                        # å•ä¸ªè§’è‰² GET/PUT/DELETE
â”œâ”€â”€ chat/
â”‚   â””â”€â”€ route.ts                            # èŠå¤©API POST
â”œâ”€â”€ models/
â”‚   â””â”€â”€ route.ts                            # æ¨¡å‹åˆ—è¡¨ GET
â””â”€â”€ presets/
    â”œâ”€â”€ route.ts                            # é¢„è®¾åˆ—è¡¨ GET/POST
    â”œâ”€â”€ [id]/
    â”‚   â””â”€â”€ route.ts                        # å•ä¸ªé¢„è®¾ PUT/DELETE
    â””â”€â”€ active/
        â””â”€â”€ route.ts                        # æ´»è·ƒé¢„è®¾ GET
```

### æ ¸å¿ƒåº“æ–‡ä»¶ (`lib/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\lib\
â”œâ”€â”€ ai/
â”‚   â””â”€â”€ models/
â”‚       â”œâ”€â”€ index.ts            # æ¨¡å‹å¯¼å‡ºå’Œå·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ providers.ts        # å®˜æ–¹æä¾›å•†é…ç½®
â”‚       â”œâ”€â”€ custom.ts           # è‡ªå®šä¹‰æä¾›å•†
â”‚       â””â”€â”€ types.ts            # ç±»å‹å®šä¹‰
â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ conversations.ts        # å¯¹è¯å­˜å‚¨
â”‚   â”œâ”€â”€ messages.ts             # æ¶ˆæ¯å­˜å‚¨
â”‚   â”œâ”€â”€ characters.ts           # è§’è‰²å­˜å‚¨
â”‚   â”œâ”€â”€ memories.ts             # è®°å¿†å­˜å‚¨
â”‚   â””â”€â”€ presets.ts              # é¢„è®¾å­˜å‚¨
â””â”€â”€ utils/
    â””â”€â”€ (å·¥å…·å‡½æ•°)
```

### çŠ¶æ€ç®¡ç† (`stores/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\stores\
â”œâ”€â”€ conversation.ts             # å¯¹è¯çŠ¶æ€Store
â”œâ”€â”€ uiPreferences.ts           # UIåå¥½Store
â””â”€â”€ character.ts               # è§’è‰²çŠ¶æ€Store
```

### è‡ªå®šä¹‰Hooks (`hooks/`)

```
D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\hooks\
â”œâ”€â”€ useConversations.ts        # å¯¹è¯åˆ—è¡¨Hook
â”œâ”€â”€ useMessages.ts             # æ¶ˆæ¯Hook
â”œâ”€â”€ useCharacters.ts           # è§’è‰²Hook
â”œâ”€â”€ useConversation.ts         # å•ä¸ªå¯¹è¯Hook
â””â”€â”€ useProviders.ts            # æä¾›å•†Hook
```

---

## ğŸ” å¿«é€Ÿæœç´¢æŒ‡å—

### æŒ‰åŠŸèƒ½æŸ¥æ‰¾

**èŠå¤©ç›¸å…³**
- å‘é€æ¶ˆæ¯ï¼š`components/chat/chat-input.tsx`
- æ˜¾ç¤ºæ¶ˆæ¯ï¼š`components/chat/message-list.tsx`, `message-bubble.tsx`
- ç¼–è¾‘æ¶ˆæ¯ï¼š`components/chat/message-editor.tsx`
- æ¶ˆæ¯æ“ä½œï¼š`components/chat/message-actions.tsx`

**è§’è‰²ç®¡ç†**
- è§’è‰²åˆ—è¡¨ï¼š`app/(main)/characters/page.tsx`
- è§’è‰²å¡ç‰‡ï¼š`components/character/character-card.tsx`
- è§’è‰²è¡¨å•ï¼š`components/character/character-form.tsx`

**æ¨¡å‹é…ç½®**
- æ¨¡å‹é€‰æ‹©ï¼š`components/chat/model-selector.tsx`
- æ¨¡å‹å‚æ•°ï¼š`components/chat/model-parameters.tsx`
- APIå¯†é’¥ï¼š`components/settings/api-keys.tsx`

**æç¤ºè¯ç®¡ç†**
- æç¤ºè¯ç¼–è¾‘ï¼š`components/prompt/prompt-editor.tsx`
- è§’è‰²æç¤ºè¯ï¼š`components/character/prompt-config.tsx`
- å¯¹è¯æç¤ºè¯ï¼š`components/chat/conversation-prompt-config.tsx`

**è°ƒè¯•å·¥å…·**
- å¼€å‘è€…é¢æ¿ï¼š`components/chat/dev-mode-panel.tsx`
- Tokenè®¡æ•°ï¼š`components/chat/token-counter.tsx`

---

## ğŸ“ æµ‹è¯•æ—¶å¦‚ä½•æ‰“å¼€æ–‡ä»¶

### VS Code
```bash
code "D:\llmèŠå¤©å®¢æˆ·ç«¯é¡¹ç›®\emotichat\components\chat\chat-input.tsx"
```

### æµè§ˆå™¨é¢„è§ˆ
```bash
npm run dev
# è®¿é—® http://localhost:3000
```

### å¿«é€Ÿå¯¼èˆª
åœ¨VS Codeä¸­ä½¿ç”¨ `Ctrl+P` ç„¶åè¾“å…¥æ–‡ä»¶åå¿«é€Ÿæ‰“å¼€

---

## ğŸ·ï¸ ç»„ä»¶æ ‡ç­¾åˆ†ç±»

### æ ¸å¿ƒç»„ä»¶ï¼ˆå¿…é¡»æµ‹è¯•ï¼‰
- `app/(main)/chat/page.tsx` - èŠå¤©é¡µé¢
- `components/chat/chat-input.tsx` - èŠå¤©è¾“å…¥
- `components/chat/message-list.tsx` - æ¶ˆæ¯åˆ—è¡¨
- `app/api/chat/route.ts` - èŠå¤©API

### é…ç½®ç»„ä»¶
- `components/settings/api-keys.tsx` - APIé…ç½®
- `components/chat/model-selector.tsx` - æ¨¡å‹é€‰æ‹©
- `components/chat/model-parameters.tsx` - å‚æ•°é…ç½®

### æ•°æ®ç®¡ç†ç»„ä»¶
- `lib/storage/conversations.ts` - å¯¹è¯å­˜å‚¨
- `lib/storage/messages.ts` - æ¶ˆæ¯å­˜å‚¨
- `lib/storage/characters.ts` - è§’è‰²å­˜å‚¨

### UIå±•ç¤ºç»„ä»¶
- `components/character/character-card.tsx` - è§’è‰²å¡ç‰‡
- `components/chat/message-bubble.tsx` - æ¶ˆæ¯æ°”æ³¡
- `components/layout/sidebar.tsx` - ä¾§è¾¹æ 

---

**æœ€åæ›´æ–°ï¼š** 2025-11-23
