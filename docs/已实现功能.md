# EmotiChat 宸插板芥?
> 存帮2025-11-27  
> 褰锛v0.2.1  
> 瀹锛?8%  
> 锔 缁撮?LLM 杈╄宸叉锛寮抽瀹绛寰缁存わ稿虫ュｄ璋锛

---

## 稿绯荤

### 1. 绀鸿绯荤锛Phase 0锛?00%锛?- 锛`{{user}}` / `{{char}}` / `{{time}}` / `{{date}}` / `{{weekday}}` / `{{location}}` / `{{device_info}}`
- 浣绗锛`{{chat_history}}` / `{{last_user_message}}` / `{{last_char_message}}`
- 瀹锛`{{setvar::x:y}}` / `{{getvar::x}}` / `{{random::a::b::c}}`
- Role ㄩ锛OpenAI/Anthropic (system/user/assistant)锛Gemini (system 骞朵?System Instructions锛user/model)
- 娉ㄥワ娣卞?妤煎锛before/after/replace
- 澶锛绌鸿娓婚绌烘杩婊ゃ搁诲骞躲Token 躲?- 娴璇锛?56/56 杩

### 2. 棰璁剧郴缁锛?00%锛?- 棰璁 CRUD婵娲?瀵煎ュ煎猴JSON锛?- 绀鸿缂杈锛搴Role娣卞害娉ㄥャ寮ㄨ?ㄦ疯惧
- 缁ф块昏锛棰璁?> 瀵硅 > 瑙

### 3. 瑙茬＄锛?00%锛?- 琛/寤/缂杈//婵娲?- 瀛娈碉绉般杩般澶村寮虹
- 绀鸿锛System Prompt寮虹姐妤煎绠＄?
### 4. 瀵硅绠＄锛?00%锛?- 琛/寤//璁剧疆
- 娑锛?缂杈//?绠＄锛娴寮涓娴寮?- 瀵硅绀鸿锛瑕骞剁户胯

---

## UI 

### 5. 渲染系统（95%）
- Markdown、代码高亮、KaTeX、表格、链接安全
- 思维链折叠：识别 `<think>`/`<thinking>`/`<thought>`，折叠开关，标签补全，LLM 辅助识别（接口暂停）
- 特殊字段渲染：正则规则、自定义样式、预置双引号/括号/星号
- HTML/CSS 渲染开关：默认关闭，UI 显示“正在开发中”提示并警告仅在可信环境下启用（同截图）
- 未完项：CSS 完全自定义工具；JavaScript 支持正常开发中（暂未对用户开放）

### 6. 流式计时器（100%）
- 流式响应自动计时，结束显示总耗时

### 7. Token 璁℃板锛100%锛?- 绮剧‘(tiktoken)/浼扮(0.5涓)锛澶妯″ Token 
- 杈ュ惰℃般瀵硅绘般绀鸿璁℃帮?0%/90%/100% 璀

### 8. 妯″╁锛100%锛?- 瀹癸OpenAI / Google Gemini / Anthropic 琛
- 瀹涔绔癸OpenAI/Gemini/Anthropic 璁锛ュ悍妫?- 帮Temperature / TopP / MaxTokens 绛?
### 9. UI 缇锛?00%锛?- 搴寮锛妗/骞虫/绉诲锛涓婚锛浜??锛ㄧ讳璁块?
### 10. 寮妯″锛?0%锛?- 50/50 灞锛瀹舵ュ锛绀鸿寤哄绀猴API 璇锋/搴锛Token 浣跨
- 寰瀹锛村寸 debug 娑涓ц芥

---

## 虹璁炬

### 11. 版瀛锛?00%锛?- 瑰锛浠剁郴缁?JSON + 浠堕?- 瀹癸瀵硅瑙层棰璁俱缃璁板锛虹锛
- 杩琛堕缃锛?`config.yaml` 缁涓/藉?璺寰/ュ锛棰璐峰锛锛`config/runtime.ts` 瑙ｆ骞惰?data/logs 璺寰锛澧宸茬Щ

### 12. 璇澶锛?00%锛?- ㄥ/灞?Error Boundary锛璇ュ锛Toast /璇/璀

### 13. API 瀵ョ＄锛?00%锛?- 娴瑙ㄦ板锛澶渚锛杩ユ璇锛妯″

### 14. ㄦ烽缃锛?00%锛?- 寤/缂杈ㄦ烽缃锛ㄦ峰绉拌剧?
---

## 

| 绫诲 | ?|
|------|------|
| 妗 | Next.js 15 + React 19 |
| 璇瑷 | TypeScript |
| UI | Tailwind CSS + shadcn/ui |
| 舵?| Zustand |
| AI SDK | Vercel AI SDK |
| 瀛 | 浠剁郴缁 (JSON) |
| Token | js-tiktoken |
| Markdown | react-markdown + remark-gfm |
| 楂浜 | highlight.js |
| 寮 | KaTeX |

---

## 宸查杩娴璇?- 绀鸿绯荤锛56/56
- Token 璁℃板锛8/8
- 澶锛ㄩㄩ杩

---

## 抽浜

| 浜 |  |
|------|------|
| `9ff2c87` | 棰璁剧郴缁涓娴寮杈烘у?|
| `7530833` | 瑙插虹 |
| `ae815b8` | 绉婚ゆч绾ц剧?|
| `192278f` | ㄦ疯茬＄ |
| `3b17072` | 瀹瑙茬＄涓澶?|
| `a6ab9b0` | 淇澶娴寮杈轰绔虫剧ず |

